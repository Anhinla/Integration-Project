{
  "version": 3,
  "sources": ["../../tiptap-extension-resize-image/lib/imageResize.ts"],
  "sourcesContent": ["import Image from '@tiptap/extension-image';\n\nexport const ImageResize = Image.extend({\n  addAttributes() {\n    return {\n      src: {\n        default: null,\n      },\n      alt: {\n        default: null,\n      },\n      style: {\n        default: 'width: 100%; height: auto; cursor: pointer;',\n        parseHTML: (element) => {\n          const width = element.getAttribute('width');\n          return width\n            ? `width: ${width}px; height: auto; cursor: pointer;`\n            : `${element.style.cssText}`;\n        },\n      },\n      title: {\n        default: null,\n      },\n      loading: {\n        default: null,\n      },\n      srcset: {\n        default: null,\n      },\n      sizes: {\n        default: null,\n      },\n      crossorigin: {\n        default: null,\n      },\n      usemap: {\n        default: null,\n      },\n      ismap: {\n        default: null,\n      },\n      width: {\n        default: null,\n      },\n      height: {\n        default: null,\n      },\n      referrerpolicy: {\n        default: null,\n      },\n      longdesc: {\n        default: null,\n      },\n      decoding: {\n        default: null,\n      },\n      class: {\n        default: null,\n      },\n      id: {\n        default: null,\n      },\n      name: {\n        default: null,\n      },\n      draggable: {\n        default: true,\n      },\n      tabindex: {\n        default: null,\n      },\n      'aria-label': {\n        default: null,\n      },\n      'aria-labelledby': {\n        default: null,\n      },\n      'aria-describedby': {\n        default: null,\n      },\n    };\n  },\n  addNodeView() {\n    return ({ node, editor, getPos }) => {\n      const {\n        view,\n        options: { editable },\n      } = editor;\n      const { style } = node.attrs;\n      const $wrapper = document.createElement('div');\n      const $container = document.createElement('div');\n      const $img = document.createElement('img');\n      const iconStyle = 'width: 24px; height: 24px; cursor: pointer;';\n\n      const dispatchNodeView = () => {\n        if (typeof getPos === 'function') {\n          const newAttrs = {\n            ...node.attrs,\n            style: `${$img.style.cssText}`,\n          };\n          view.dispatch(view.state.tr.setNodeMarkup(getPos(), null, newAttrs));\n        }\n      };\n      const paintPositionContoller = () => {\n        const $postionController = document.createElement('div');\n\n        const $leftController = document.createElement('img');\n        const $centerController = document.createElement('img');\n        const $rightController = document.createElement('img');\n\n        const controllerMouseOver = (e) => {\n          e.target.style.opacity = 0.3;\n        };\n\n        const controllerMouseOut = (e) => {\n          e.target.style.opacity = 1;\n        };\n\n        $postionController.setAttribute(\n          'style',\n          'position: absolute; top: 0%; left: 50%; width: 100px; height: 25px; z-index: 999; background-color: rgba(255, 255, 255, 0.7); border-radius: 4px; border: 2px solid #6C6C6C; cursor: pointer; transform: translate(-50%, -50%); display: flex; justify-content: space-between; align-items: center; padding: 0 10px;'\n        );\n\n        $leftController.setAttribute(\n          'src',\n          'https://fonts.gstatic.com/s/i/short-term/release/materialsymbolsoutlined/format_align_left/default/20px.svg'\n        );\n        $leftController.setAttribute('style', iconStyle);\n        $leftController.addEventListener('mouseover', controllerMouseOver);\n        $leftController.addEventListener('mouseout', controllerMouseOut);\n\n        $centerController.setAttribute(\n          'src',\n          'https://fonts.gstatic.com/s/i/short-term/release/materialsymbolsoutlined/format_align_center/default/20px.svg'\n        );\n        $centerController.setAttribute('style', iconStyle);\n        $centerController.addEventListener('mouseover', controllerMouseOver);\n        $centerController.addEventListener('mouseout', controllerMouseOut);\n\n        $rightController.setAttribute(\n          'src',\n          'https://fonts.gstatic.com/s/i/short-term/release/materialsymbolsoutlined/format_align_right/default/20px.svg'\n        );\n        $rightController.setAttribute('style', iconStyle);\n        $rightController.addEventListener('mouseover', controllerMouseOver);\n        $rightController.addEventListener('mouseout', controllerMouseOut);\n\n        $leftController.addEventListener('click', () => {\n          $img.setAttribute('style', `${$img.style.cssText} margin: 0 auto 0 0;`);\n          dispatchNodeView();\n        });\n        $centerController.addEventListener('click', () => {\n          $img.setAttribute('style', `${$img.style.cssText} margin: 0 auto;`);\n          dispatchNodeView();\n        });\n        $rightController.addEventListener('click', () => {\n          $img.setAttribute('style', `${$img.style.cssText} margin: 0 0 0 auto;`);\n          dispatchNodeView();\n        });\n\n        $postionController.appendChild($leftController);\n        $postionController.appendChild($centerController);\n        $postionController.appendChild($rightController);\n\n        $container.appendChild($postionController);\n      };\n\n      $wrapper.setAttribute('style', `display: flex;`);\n      $wrapper.appendChild($container);\n\n      $container.setAttribute('style', `${style}`);\n      $container.appendChild($img);\n\n      Object.entries(node.attrs).forEach(([key, value]) => {\n        if (value === undefined || value === null) return;\n        $img.setAttribute(key, value);\n      });\n\n      if (!editable) return { dom: $img };\n      const isMobile = document.documentElement.clientWidth < 768;\n      const dotPosition = isMobile ? '-8px' : '-4px';\n      const dotsPosition = [\n        `top: ${dotPosition}; left: ${dotPosition}; cursor: nwse-resize;`,\n        `top: ${dotPosition}; right: ${dotPosition}; cursor: nesw-resize;`,\n        `bottom: ${dotPosition}; left: ${dotPosition}; cursor: nesw-resize;`,\n        `bottom: ${dotPosition}; right: ${dotPosition}; cursor: nwse-resize;`,\n      ];\n\n      let isResizing = false;\n      let startX: number, startWidth: number;\n\n      $container.addEventListener('click', (e) => {\n        //remove remaining dots and position controller\n        const isMobile = document.documentElement.clientWidth < 768;\n        isMobile && (document.querySelector('.ProseMirror-focused') as HTMLElement)?.blur();\n\n        if ($container.childElementCount > 3) {\n          for (let i = 0; i < 5; i++) {\n            $container.removeChild($container.lastChild as Node);\n          }\n        }\n\n        paintPositionContoller();\n\n        $container.setAttribute(\n          'style',\n          `position: relative; border: 1px dashed #6C6C6C; ${style} cursor: pointer;`\n        );\n\n        Array.from({ length: 4 }, (_, index) => {\n          const $dot = document.createElement('div');\n          $dot.setAttribute(\n            'style',\n            `position: absolute; width: ${isMobile ? 16 : 9}px; height: ${isMobile ? 16 : 9}px; border: 1.5px solid #6C6C6C; border-radius: 50%; ${dotsPosition[index]}`\n          );\n\n          $dot.addEventListener('mousedown', (e) => {\n            e.preventDefault();\n            isResizing = true;\n            startX = e.clientX;\n            startWidth = $container.offsetWidth;\n\n            const onMouseMove = (e: MouseEvent) => {\n              if (!isResizing) return;\n              const deltaX = index % 2 === 0 ? -(e.clientX - startX) : e.clientX - startX;\n\n              const newWidth = startWidth + deltaX;\n\n              $container.style.width = newWidth + 'px';\n\n              $img.style.width = newWidth + 'px';\n            };\n\n            const onMouseUp = () => {\n              if (isResizing) {\n                isResizing = false;\n              }\n              dispatchNodeView();\n\n              document.removeEventListener('mousemove', onMouseMove);\n              document.removeEventListener('mouseup', onMouseUp);\n            };\n\n            document.addEventListener('mousemove', onMouseMove);\n            document.addEventListener('mouseup', onMouseUp);\n          });\n\n          $dot.addEventListener(\n            'touchstart',\n            (e) => {\n              e.cancelable && e.preventDefault();\n              isResizing = true;\n              startX = e.touches[0].clientX;\n              startWidth = $container.offsetWidth;\n\n              const onTouchMove = (e: TouchEvent) => {\n                if (!isResizing) return;\n                const deltaX =\n                  index % 2 === 0\n                    ? -(e.touches[0].clientX - startX)\n                    : e.touches[0].clientX - startX;\n\n                const newWidth = startWidth + deltaX;\n\n                $container.style.width = newWidth + 'px';\n\n                $img.style.width = newWidth + 'px';\n              };\n\n              const onTouchEnd = () => {\n                if (isResizing) {\n                  isResizing = false;\n                }\n                dispatchNodeView();\n\n                document.removeEventListener('touchmove', onTouchMove);\n                document.removeEventListener('touchend', onTouchEnd);\n              };\n\n              document.addEventListener('touchmove', onTouchMove);\n              document.addEventListener('touchend', onTouchEnd);\n            },\n            { passive: false }\n          );\n          $container.appendChild($dot);\n        });\n      });\n\n      document.addEventListener('click', (e: MouseEvent) => {\n        const $target = e.target as HTMLElement;\n        const isClickInside = $container.contains($target) || $target.style.cssText === iconStyle;\n\n        if (!isClickInside) {\n          const containerStyle = $container.getAttribute('style');\n          const newStyle = containerStyle?.replace('border: 1px dashed #6C6C6C;', '');\n          $container.setAttribute('style', newStyle as string);\n\n          if ($container.childElementCount > 3) {\n            for (let i = 0; i < 5; i++) {\n              $container.removeChild($container.lastChild as Node);\n            }\n          }\n        }\n      });\n\n      return {\n        dom: $wrapper,\n      };\n    };\n  },\n});\n"],
  "mappings": ";;;;;;;AAEa,IAAA,cAAc,MAAM,OAAO;EACtC,gBAAa;AACX,WAAO;MACL,KAAK;QACH,SAAS;MACV;MACD,KAAK;QACH,SAAS;MACV;MACD,OAAO;QACL,SAAS;QACT,WAAW,CAAC,YAAW;AACrB,gBAAM,QAAQ,QAAQ,aAAa,OAAO;AAC1C,iBAAO,QACH,UAAU,KAAK,uCACf,GAAG,QAAQ,MAAM,OAAO;;MAE/B;MACD,OAAO;QACL,SAAS;MACV;MACD,SAAS;QACP,SAAS;MACV;MACD,QAAQ;QACN,SAAS;MACV;MACD,OAAO;QACL,SAAS;MACV;MACD,aAAa;QACX,SAAS;MACV;MACD,QAAQ;QACN,SAAS;MACV;MACD,OAAO;QACL,SAAS;MACV;MACD,OAAO;QACL,SAAS;MACV;MACD,QAAQ;QACN,SAAS;MACV;MACD,gBAAgB;QACd,SAAS;MACV;MACD,UAAU;QACR,SAAS;MACV;MACD,UAAU;QACR,SAAS;MACV;MACD,OAAO;QACL,SAAS;MACV;MACD,IAAI;QACF,SAAS;MACV;MACD,MAAM;QACJ,SAAS;MACV;MACD,WAAW;QACT,SAAS;MACV;MACD,UAAU;QACR,SAAS;MACV;MACD,cAAc;QACZ,SAAS;MACV;MACD,mBAAmB;QACjB,SAAS;MACV;MACD,oBAAoB;QAClB,SAAS;MACV;;;EAGL,cAAW;AACT,WAAO,CAAC,EAAE,MAAM,QAAQ,OAAM,MAAM;AAClC,YAAM,EACJ,MACA,SAAS,EAAE,SAAQ,EAAE,IACnB;AACJ,YAAM,EAAE,MAAK,IAAK,KAAK;AACvB,YAAM,WAAW,SAAS,cAAc,KAAK;AAC7C,YAAM,aAAa,SAAS,cAAc,KAAK;AAC/C,YAAM,OAAO,SAAS,cAAc,KAAK;AACzC,YAAM,YAAY;AAElB,YAAM,mBAAmB,MAAK;AAC5B,YAAI,OAAO,WAAW,YAAY;AAChC,gBAAM,WACD,OAAA,OAAA,OAAA,OAAA,CAAA,GAAA,KAAK,KAAK,GAAA,EACb,OAAO,GAAG,KAAK,MAAM,OAAO,GAAE,CAAA;AAEhC,eAAK,SAAS,KAAK,MAAM,GAAG,cAAc,OAAM,GAAI,MAAM,QAAQ,CAAC;QACpE;MACH;AACA,YAAM,yBAAyB,MAAK;AAClC,cAAM,qBAAqB,SAAS,cAAc,KAAK;AAEvD,cAAM,kBAAkB,SAAS,cAAc,KAAK;AACpD,cAAM,oBAAoB,SAAS,cAAc,KAAK;AACtD,cAAM,mBAAmB,SAAS,cAAc,KAAK;AAErD,cAAM,sBAAsB,CAAC,MAAK;AAChC,YAAE,OAAO,MAAM,UAAU;QAC3B;AAEA,cAAM,qBAAqB,CAAC,MAAK;AAC/B,YAAE,OAAO,MAAM,UAAU;QAC3B;AAEA,2BAAmB,aACjB,SACA,sTAAsT;AAGxT,wBAAgB,aACd,OACA,6GAA6G;AAE/G,wBAAgB,aAAa,SAAS,SAAS;AAC/C,wBAAgB,iBAAiB,aAAa,mBAAmB;AACjE,wBAAgB,iBAAiB,YAAY,kBAAkB;AAE/D,0BAAkB,aAChB,OACA,+GAA+G;AAEjH,0BAAkB,aAAa,SAAS,SAAS;AACjD,0BAAkB,iBAAiB,aAAa,mBAAmB;AACnE,0BAAkB,iBAAiB,YAAY,kBAAkB;AAEjE,yBAAiB,aACf,OACA,8GAA8G;AAEhH,yBAAiB,aAAa,SAAS,SAAS;AAChD,yBAAiB,iBAAiB,aAAa,mBAAmB;AAClE,yBAAiB,iBAAiB,YAAY,kBAAkB;AAEhE,wBAAgB,iBAAiB,SAAS,MAAK;AAC7C,eAAK,aAAa,SAAS,GAAG,KAAK,MAAM,OAAO,sBAAsB;AACtE,2BAAgB;QAClB,CAAC;AACD,0BAAkB,iBAAiB,SAAS,MAAK;AAC/C,eAAK,aAAa,SAAS,GAAG,KAAK,MAAM,OAAO,kBAAkB;AAClE,2BAAgB;QAClB,CAAC;AACD,yBAAiB,iBAAiB,SAAS,MAAK;AAC9C,eAAK,aAAa,SAAS,GAAG,KAAK,MAAM,OAAO,sBAAsB;AACtE,2BAAgB;QAClB,CAAC;AAED,2BAAmB,YAAY,eAAe;AAC9C,2BAAmB,YAAY,iBAAiB;AAChD,2BAAmB,YAAY,gBAAgB;AAE/C,mBAAW,YAAY,kBAAkB;MAC3C;AAEA,eAAS,aAAa,SAAS,gBAAgB;AAC/C,eAAS,YAAY,UAAU;AAE/B,iBAAW,aAAa,SAAS,GAAG,KAAK,EAAE;AAC3C,iBAAW,YAAY,IAAI;AAE3B,aAAO,QAAQ,KAAK,KAAK,EAAE,QAAQ,CAAC,CAAC,KAAK,KAAK,MAAK;AAClD,YAAI,UAAU,UAAa,UAAU;AAAM;AAC3C,aAAK,aAAa,KAAK,KAAK;MAC9B,CAAC;AAED,UAAI,CAAC;AAAU,eAAO,EAAE,KAAK,KAAI;AACjC,YAAM,WAAW,SAAS,gBAAgB,cAAc;AACxD,YAAM,cAAc,WAAW,SAAS;AACxC,YAAM,eAAe;QACnB,QAAQ,WAAW,WAAW,WAAW;QACzC,QAAQ,WAAW,YAAY,WAAW;QAC1C,WAAW,WAAW,WAAW,WAAW;QAC5C,WAAW,WAAW,YAAY,WAAW;;AAG/C,UAAI,aAAa;AACjB,UAAI,QAAgB;AAEpB,iBAAW,iBAAiB,SAAS,CAAC,MAAK;;AAEzC,cAAMA,YAAW,SAAS,gBAAgB,cAAc;AACxD,QAAAA,eAAY,KAAC,SAAS,cAAc,sBAAsB,OAAmB,QAAA,OAAA,SAAA,SAAA,GAAA,KAAI;AAEjF,YAAI,WAAW,oBAAoB,GAAG;AACpC,mBAAS,IAAI,GAAG,IAAI,GAAG,KAAK;AAC1B,uBAAW,YAAY,WAAW,SAAiB;UACpD;QACF;AAED,+BAAsB;AAEtB,mBAAW,aACT,SACA,mDAAmD,KAAK,mBAAmB;AAG7E,cAAM,KAAK,EAAE,QAAQ,EAAC,GAAI,CAAC,GAAG,UAAS;AACrC,gBAAM,OAAO,SAAS,cAAc,KAAK;AACzC,eAAK,aACH,SACA,8BAA8BA,YAAW,KAAK,CAAC,eAAeA,YAAW,KAAK,CAAC,wDAAwD,aAAa,KAAK,CAAC,EAAE;AAG9J,eAAK,iBAAiB,aAAa,CAACC,OAAK;AACvC,YAAAA,GAAE,eAAc;AAChB,yBAAa;AACb,qBAASA,GAAE;AACX,yBAAa,WAAW;AAExB,kBAAM,cAAc,CAACA,OAAiB;AACpC,kBAAI,CAAC;AAAY;AACjB,oBAAM,SAAS,QAAQ,MAAM,IAAI,EAAEA,GAAE,UAAU,UAAUA,GAAE,UAAU;AAErE,oBAAM,WAAW,aAAa;AAE9B,yBAAW,MAAM,QAAQ,WAAW;AAEpC,mBAAK,MAAM,QAAQ,WAAW;YAChC;AAEA,kBAAM,YAAY,MAAK;AACrB,kBAAI,YAAY;AACd,6BAAa;cACd;AACD,+BAAgB;AAEhB,uBAAS,oBAAoB,aAAa,WAAW;AACrD,uBAAS,oBAAoB,WAAW,SAAS;YACnD;AAEA,qBAAS,iBAAiB,aAAa,WAAW;AAClD,qBAAS,iBAAiB,WAAW,SAAS;UAChD,CAAC;AAED,eAAK,iBACH,cACA,CAACA,OAAK;AACJ,YAAAA,GAAE,cAAcA,GAAE,eAAc;AAChC,yBAAa;AACb,qBAASA,GAAE,QAAQ,CAAC,EAAE;AACtB,yBAAa,WAAW;AAExB,kBAAM,cAAc,CAACA,OAAiB;AACpC,kBAAI,CAAC;AAAY;AACjB,oBAAM,SACJ,QAAQ,MAAM,IACV,EAAEA,GAAE,QAAQ,CAAC,EAAE,UAAU,UACzBA,GAAE,QAAQ,CAAC,EAAE,UAAU;AAE7B,oBAAM,WAAW,aAAa;AAE9B,yBAAW,MAAM,QAAQ,WAAW;AAEpC,mBAAK,MAAM,QAAQ,WAAW;YAChC;AAEA,kBAAM,aAAa,MAAK;AACtB,kBAAI,YAAY;AACd,6BAAa;cACd;AACD,+BAAgB;AAEhB,uBAAS,oBAAoB,aAAa,WAAW;AACrD,uBAAS,oBAAoB,YAAY,UAAU;YACrD;AAEA,qBAAS,iBAAiB,aAAa,WAAW;AAClD,qBAAS,iBAAiB,YAAY,UAAU;UAClD,GACA,EAAE,SAAS,MAAK,CAAE;AAEpB,qBAAW,YAAY,IAAI;QAC7B,CAAC;MACH,CAAC;AAED,eAAS,iBAAiB,SAAS,CAAC,MAAiB;AACnD,cAAM,UAAU,EAAE;AAClB,cAAM,gBAAgB,WAAW,SAAS,OAAO,KAAK,QAAQ,MAAM,YAAY;AAEhF,YAAI,CAAC,eAAe;AAClB,gBAAM,iBAAiB,WAAW,aAAa,OAAO;AACtD,gBAAM,WAAW,mBAAc,QAAd,mBAAA,SAAA,SAAA,eAAgB,QAAQ,+BAA+B,EAAE;AAC1E,qBAAW,aAAa,SAAS,QAAkB;AAEnD,cAAI,WAAW,oBAAoB,GAAG;AACpC,qBAAS,IAAI,GAAG,IAAI,GAAG,KAAK;AAC1B,yBAAW,YAAY,WAAW,SAAiB;YACpD;UACF;QACF;MACH,CAAC;AAED,aAAO;QACL,KAAK;;IAET;;AAEH,CAAA;",
  "names": ["isMobile", "e"]
}
